<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Khichi Hosting Panel</title>
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --bg-color: #0c0c0c; /* Very Dark Background */
            --card-color: #151515; /* Card Background */
            --btn-color: #1e1e1e;
            --accent-green: #00dc82; /* The Green from Screenshot */
            --text-white: #ffffff;
            --text-gray: #a1a1aa;
            --border: #333333;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', sans-serif; }

        body {
            background-color: var(--bg-color);
            color: var(--text-white);
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }

        /* --- Main Container --- */
        .container {
            width: 100%;
            max-width: 450px;
            padding: 20px;
        }

        .header-text {
            text-align: center;
            font-size: 1.2rem;
            color: var(--text-gray);
            margin-bottom: 30px;
            font-weight: 400;
        }

        /* --- Buttons Grid --- */
        .menu-grid {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .action-card {
            background-color: var(--btn-color);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 25px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .action-card:hover {
            border-color: var(--accent-green);
            background-color: #252525;
            transform: translateY(-2px);
        }

        /* Icon Styling */
        .icon-box {
            width: 50px;
            height: 50px;
            background-color: var(--accent-green);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
            margin-bottom: 15px;
            box-shadow: 0 4px 15px rgba(0, 220, 130, 0.4);
        }

        .card-label {
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-white);
        }

        /* --- Hidden Views (Upload Sections) --- */
        .view-section {
            display: none; /* Hidden by default */
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: var(--bg-color);
            padding: 20px;
            overflow-y: auto;
            animation: fadeIn 0.3s ease;
        }

        .view-header {
            display: flex;
            align-items: center;
            margin-bottom: 30px;
        }

        .back-btn {
            background: none;
            border: none;
            color: var(--text-white);
            font-size: 1.5rem;
            cursor: pointer;
            margin-right: 15px;
        }

        /* --- Hosted Items List --- */
        .hosted-item {
            background: var(--card-color);
            border: 1px solid var(--border);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .item-info h4 { font-size: 0.9rem; margin-bottom: 5px; }
        .item-info span { font-size: 0.7rem; color: var(--text-gray); }

        .btn-view {
            background: var(--accent-green);
            color: black;
            padding: 8px 15px;
            border-radius: 6px;
            text-decoration: none;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .btn-delete {
            background: #ff4444;
            color: white;
            border: none;
            padding: 8px;
            border-radius: 6px;
            cursor: pointer;
            margin-left: 5px;
        }

        /* --- Upload Inputs --- */
        .upload-trigger {
            background: var(--card-color);
            border: 2px dashed var(--border);
            padding: 40px;
            text-align: center;
            border-radius: 15px;
            cursor: pointer;
            margin-bottom: 30px;
            color: var(--text-gray);
        }
        .upload-trigger:hover { border-color: var(--accent-green); color: var(--accent-green); }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

    </style>
</head>
<body>

    <!-- MAIN MENU (Exact UI Clone) -->
    <div class="container" id="main-menu">
        <h2 class="header-text">What would you like to do?</h2>

        <div class="menu-grid">
            
            <!-- Upload Image -->
            <div class="action-card" onclick="App.openSection('image')">
                <div class="icon-box"><i class="fas fa-image"></i></div>
                <div class="card-label">Upload Image</div>
            </div>

            <!-- Upload Video -->
            <div class="action-card" onclick="App.openSection('video')">
                <div class="icon-box"><i class="fas fa-film"></i></div>
                <div class="card-label">Upload Video</div>
            </div>

            <!-- Upload Audio -->
            <div class="action-card" onclick="App.openSection('audio')">
                <div class="icon-box"><i class="fas fa-music"></i></div>
                <div class="card-label">Upload Audio</div>
            </div>

            <!-- Host Website -->
            <div class="action-card" onclick="App.openSection('website')">
                <div class="icon-box"><i class="fas fa-code"></i></div>
                <div class="card-label">Host Website</div>
            </div>

        </div>
    </div>

    <!-- GENERIC UPLOAD SECTION (Hidden) -->
    <div id="upload-section" class="view-section">
        <div class="view-header">
            <button class="back-btn" onclick="App.goHome()"><i class="fas fa-arrow-left"></i></button>
            <h2 id="section-title">Upload</h2>
        </div>

        <div class="upload-trigger" onclick="document.getElementById('file-input').click()">
            <i class="fas fa-cloud-upload-alt" style="font-size: 2rem; margin-bottom: 10px;"></i>
            <p>Click to Select File</p>
            <small id="file-hint">Supported: .jpg, .png</small>
        </div>
        
        <input type="file" id="file-input" hidden onchange="App.handleUpload(this)">

        <h3 style="margin-bottom: 15px; color: var(--text-gray);">Your Hosted Files</h3>
        <div id="file-list">
            <!-- Items appear here -->
        </div>
    </div>

    <script>
        // --- DATABASE SETUP (IndexedDB) ---
        // Ye data ko browser mein permanent save karta hai
        const DB_NAME = 'KhichiHostDB';
        let db;

        const request = indexedDB.open(DB_NAME, 1);
        request.onupgradeneeded = function(e) {
            db = e.target.result;
            if (!db.objectStoreNames.contains('files')) {
                db.createObjectStore('files', { keyPath: 'id', autoIncrement: true });
            }
        };
        request.onsuccess = function(e) {
            db = e.target.result;
        };

        // --- APP LOGIC ---
        const App = {
            currentType: '',

            // Open specific section (Image, Video, etc.)
            openSection: (type) => {
                App.currentType = type;
                document.getElementById('main-menu').style.display = 'none';
                document.getElementById('upload-section').style.display = 'block';
                
                // Update UI Texts
                let title = '', hint = '', accept = '';
                if(type === 'image') { title = 'Upload Image'; hint = 'JPG, PNG, GIF'; accept = 'image/*'; }
                if(type === 'video') { title = 'Upload Video'; hint = 'MP4, MKV'; accept = 'video/*'; }
                if(type === 'audio') { title = 'Upload Audio'; hint = 'MP3, WAV'; accept = 'audio/*'; }
                if(type === 'website') { title = 'Host Website'; hint = 'Upload index.html file'; accept = '.html'; }

                document.getElementById('section-title').innerText = title;
                document.getElementById('file-hint').innerText = hint;
                document.getElementById('file-input').setAttribute('accept', accept);
                
                App.loadFiles();
            },

            // Go back to Main Menu
            goHome: () => {
                document.getElementById('upload-section').style.display = 'none';
                document.getElementById('main-menu').style.display = 'block';
            },

            // Handle File Selection
            handleUpload: (input) => {
                const file = input.files[0];
                if (!file) return;

                const transaction = db.transaction(['files'], 'readwrite');
                const store = transaction.objectStore('files');

                const record = {
                    name: file.name,
                    type: App.currentType, // image, video, or website
                    data: file,
                    date: new Date().toLocaleDateString()
                };

                store.add(record);
                
                transaction.oncomplete = () => {
                    alert("Upload Successful!");
                    input.value = ''; // Clear input
                    App.loadFiles();
                };
            },

            // Load and Show Files
            loadFiles: () => {
                const list = document.getElementById('file-list');
                list.innerHTML = '';

                const transaction = db.transaction(['files'], 'readonly');
                const store = transaction.objectStore('files');
                const request = store.getAll();

                request.onsuccess = () => {
                    // Filter files based on current section
                    const files = request.result.filter(f => f.type === App.currentType).reverse();

                    if(files.length === 0) {
                        list.innerHTML = '<p style="text-align:center; color:#555;">No files found.</p>';
                        return;
                    }

                    files.forEach(file => {
                        // Create a viewable URL
                        const url = URL.createObjectURL(file.data);
                        
                        let icon = 'fa-file';
                        if(file.type === 'website') icon = 'fa-globe';
                        if(file.type === 'image') icon = 'fa-image';
                        if(file.type === 'video') icon = 'fa-film';
                        if(file.type === 'audio') icon = 'fa-music';

                        const div = document.createElement('div');
                        div.className = 'hosted-item';
                        div.innerHTML = `
                            <div class="item-info" style="display:flex; align-items:center; gap:10px;">
                                <div style="background:#222; width:40px; height:40px; display:flex; align-items:center; justify-content:center; border-radius:8px; color:var(--accent-green);">
                                    <i class="fas ${icon}"></i>
                                </div>
                                <div>
                                    <h4>${file.name}</h4>
                                    <span>${(file.data.size/1024).toFixed(1)} KB â€¢ ${file.date}</span>
                                </div>
                            </div>
                            <div style="display:flex; align-items:center;">
                                <a href="${url}" target="_blank" class="btn-view">
                                    ${file.type === 'website' ? 'Open Site' : 'View'}
                                </a>
                                <button onclick="App.deleteFile(${file.id})" class="btn-delete"><i class="fas fa-trash"></i></button>
                            </div>
                        `;
                        list.appendChild(div);
                    });
                };
            },

            deleteFile: (id) => {
                if(confirm("Delete this file?")) {
                    const transaction = db.transaction(['files'], 'readwrite');
                    const store = transaction.objectStore('files');
                    store.delete(id);
                    transaction.oncomplete = () => App.loadFiles();
                }
            }
        };

    </script>
</body>
</html>
