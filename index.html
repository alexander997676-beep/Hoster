<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HOSTER by FAIZAN AHMED</title>
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@400;600;700&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
    <!-- Zip Library for Extracting Files -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>

    <style>
        :root {
            --bg-dark: #050505;
            --bg-panel: #0f0f13;
            --primary: #00e5ff; /* Cyan for Faizan */
            --primary-glow: rgba(0, 229, 255, 0.4);
            --secondary: #7000ff;
            --text: #ffffff;
            --text-dim: #888888;
            --border: #333333;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            background-color: var(--bg-dark);
            color: var(--text);
            font-family: 'Rajdhani', sans-serif;
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* --- Header --- */
        .header {
            height: 60px;
            background: var(--bg-panel);
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            z-index: 10;
        }

        .brand {
            font-size: 1.5rem;
            font-weight: 700;
            letter-spacing: 1px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .brand span { color: var(--primary); text-shadow: 0 0 10px var(--primary-glow); }

        /* --- Navigation --- */
        .nav-tabs {
            display: flex;
            gap: 5px;
            background: #000;
            padding: 5px;
            border-radius: 8px;
            border: 1px solid var(--border);
        }

        .nav-btn {
            padding: 8px 20px;
            border: none;
            background: transparent;
            color: var(--text-dim);
            font-family: 'Rajdhani', sans-serif;
            font-weight: 600;
            cursor: pointer;
            border-radius: 4px;
            transition: 0.3s;
        }

        .nav-btn.active {
            background: var(--primary);
            color: #000;
            box-shadow: 0 0 15px var(--primary-glow);
        }

        /* --- Main Content Area --- */
        .main-container {
            flex: 1;
            position: relative;
            overflow: hidden;
        }

        .view-section {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            display: none; /* Hidden by default */
            padding: 20px;
            overflow-y: auto;
        }

        .view-section.active { display: block; }

        /* --- SECTION 1: DRIVE (APKs, Media) --- */
        .drive-upload {
            border: 2px dashed var(--border);
            border-radius: 12px;
            padding: 40px;
            text-align: center;
            background: rgba(255,255,255,0.02);
            cursor: pointer;
            transition: 0.3s;
        }
        .drive-upload:hover { border-color: var(--primary); background: rgba(0, 229, 255, 0.05); }

        .files-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .file-card {
            background: var(--bg-panel);
            border: 1px solid var(--border);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            position: relative;
        }

        .file-icon { font-size: 3rem; margin-bottom: 10px; color: var(--text-dim); }
        .file-icon.apk { color: #00e676; }
        .file-icon.img { color: #ff4081; }
        .file-icon.vid { color: #2979ff; }

        /* --- SECTION 2: CODE STUDIO (HTML/CSS/JS/ZIP) --- */
        .studio-layout {
            display: grid;
            grid-template-columns: 350px 1fr;
            height: 100%;
            gap: 10px;
        }

        .editor-panel {
            background: var(--bg-panel);
            border: 1px solid var(--border);
            display: flex;
            flex-direction: column;
        }

        .editor-header {
            padding: 10px;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
        }

        .code-tabs { display: flex; gap: 5px; }
        .code-tab { 
            background: #222; border: none; color: #888; padding: 5px 10px; cursor: pointer; font-size: 0.8rem;
        }
        .code-tab.active { background: var(--bg-dark); color: var(--primary); border-top: 2px solid var(--primary); }

        .code-area {
            flex: 1;
            background: #080808;
            color: #d4d4d4;
            border: none;
            padding: 10px;
            font-family: 'JetBrains Mono', monospace;
            resize: none;
            font-size: 0.9rem;
            outline: none;
        }

        .preview-panel {
            background: white;
            border: 1px solid var(--border);
            position: relative;
        }

        iframe { width: 100%; height: 100%; border: none; }

        /* --- Controls --- */
        .btn {
            background: var(--primary);
            color: black;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }
        .btn:hover { background: #fff; }
        .btn-outline { background: transparent; border: 1px solid var(--border); color: white; }
        
        .zip-upload-btn {
            width: 100%;
            padding: 15px;
            background: #222;
            color: var(--primary);
            border: 1px dashed var(--border);
            margin-bottom: 10px;
            cursor: pointer;
            text-align: center;
            font-size: 0.9rem;
        }
        .zip-upload-btn:hover { background: #333; }

        /* Toast Notification */
        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--primary);
            color: black;
            padding: 10px 20px;
            border-radius: 5px;
            font-weight: bold;
            display: none;
            animation: slideIn 0.3s;
        }
        @keyframes slideIn { from { transform: translateX(100%); } to { transform: translateX(0); } }

    </style>
</head>
<body>

    <!-- Header -->
    <header class="header">
        <div class="brand">
            <i class="fas fa-server"></i>
            HOSTER <span>by FAIZAN AHMED</span>
        </div>
        <nav class="nav-tabs">
            <button class="nav-btn active" onclick="switchView('drive')">FILE DRIVE</button>
            <button class="nav-btn" onclick="switchView('studio')">CODE STUDIO</button>
        </nav>
        <div style="font-size:0.8rem; color: #666;">v3.0 ULTIMATE</div>
    </header>

    <div class="main-container">

        <!-- VIEW 1: FILE DRIVE (For APKs, Images, Videos) -->
        <div id="view-drive" class="view-section active">
            <h2 style="margin-bottom: 15px;">Cloud Storage</h2>
            
            <div class="drive-upload" onclick="document.getElementById('drive-input').click()">
                <i class="fas fa-cloud-upload-alt" style="font-size: 3rem; color: var(--primary); margin-bottom: 10px;"></i>
                <h3>Click to Upload Files</h3>
                <p style="color:#666">Supports .APK, .JPG, .MP4, .PDF</p>
                <input type="file" id="drive-input" hidden multiple onchange="handleDriveUpload(this)">
            </div>

            <div class="files-grid" id="drive-list">
                <!-- Files appear here -->
            </div>
        </div>

        <!-- VIEW 2: CODE STUDIO (For HTML/CSS/JS & ZIPS) -->
        <div id="view-studio" class="view-section" style="padding:0;">
            <div class="studio-layout">
                <!-- Left: Editor -->
                <div class="editor-panel">
                    
                    <!-- Zip Import Tool -->
                    <div class="zip-upload-btn" onclick="document.getElementById('zip-input').click()">
                        <i class="fas fa-file-archive"></i> IMPORT ZIP / HTML FILE
                        <input type="file" id="zip-input" hidden accept=".zip,.html" onchange="handleZipUpload(this)">
                    </div>

                    <div class="editor-header">
                        <div class="code-tabs">
                            <button class="code-tab active" onclick="setTab('html')">HTML</button>
                            <button class="code-tab" onclick="setTab('css')">CSS</button>
                            <button class="code-tab" onclick="setTab('js')">JS</button>
                        </div>
                        <button class="btn" style="padding: 2px 10px; font-size:0.8rem;" onclick="runCode()">
                            <i class="fas fa-play"></i> RUN
                        </button>
                    </div>

                    <textarea id="code-html" class="code-area" placeholder="<!-- HTML goes here -->"></textarea>
                    <textarea id="code-css" class="code-area" style="display:none" placeholder="/* CSS goes here */"></textarea>
                    <textarea id="code-js" class="code-area" style="display:none" placeholder="// JS goes here"></textarea>
                    
                    <div style="padding:10px; border-top:1px solid var(--border); text-align:center;">
                        <button class="btn btn-outline" style="width:100%" onclick="downloadProject()">
                            <i class="fas fa-download"></i> DOWNLOAD PROJECT
                        </button>
                    </div>
                </div>

                <!-- Right: Preview -->
                <div class="preview-panel">
                    <iframe id="preview-frame"></iframe>
                </div>
            </div>
        </div>

    </div>

    <div class="toast" id="toast">Operation Successful</div>

    <script>
        // --- INITIALIZATION & DATABASE ---
        let db;
        const request = indexedDB.open("FaizanHosterDB", 1);

        request.onupgradeneeded = function(e) {
            db = e.target.result;
            if (!db.objectStoreNames.contains('files')) {
                db.createObjectStore('files', { keyPath: 'id', autoIncrement: true });
            }
        };

        request.onsuccess = function(e) {
            db = e.target.result;
            loadFiles();
        };

        // --- NAVIGATION ---
        function switchView(view) {
            document.querySelectorAll('.view-section').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.nav-btn').forEach(el => el.classList.remove('active'));
            
            document.getElementById('view-' + view).classList.add('active');
            if(view === 'drive') document.querySelectorAll('.nav-btn')[0].classList.add('active');
            if(view === 'studio') document.querySelectorAll('.nav-btn')[1].classList.add('active');
        }

        // --- SECTION 1: DRIVE LOGIC ---
        function handleDriveUpload(input) {
            const files = input.files;
            if (!files.length) return;

            const transaction = db.transaction(['files'], 'readwrite');
            const store = transaction.objectStore('files');

            Array.from(files).forEach(file => {
                const record = {
                    name: file.name,
                    type: file.type,
                    data: file,
                    date: new Date().toLocaleDateString()
                };
                store.add(record);
            });

            transaction.oncomplete = () => {
                showToast("Files Uploaded Successfully!");
                loadFiles();
            };
        }

        function loadFiles() {
            const container = document.getElementById('drive-list');
            container.innerHTML = '';
            
            const transaction = db.transaction(['files'], 'readonly');
            const store = transaction.objectStore('files');
            const request = store.getAll();

            request.onsuccess = () => {
                const files = request.result.reverse(); // Newest first
                files.forEach(file => {
                    const url = URL.createObjectURL(file.data);
                    
                    let icon = 'fa-file';
                    let colorClass = '';

                    if(file.name.endsWith('.apk')) { icon = 'fa-android'; colorClass = 'apk'; }
                    else if(file.type.startsWith('image')) { icon = 'fa-image'; colorClass = 'img'; }
                    else if(file.type.startsWith('video')) { icon = 'fa-video'; colorClass = 'vid'; }
                    else if(file.name.endsWith('.zip')) { icon = 'fa-file-archive'; }

                    const div = document.createElement('div');
                    div.className = 'file-card';
                    div.innerHTML = `
                        <i class="fas ${icon} file-icon ${colorClass}"></i>
                        <div style="font-weight:bold; overflow:hidden; text-overflow:ellipsis; white-space:nowrap;">${file.name}</div>
                        <div style="font-size:0.8rem; color:#666; margin-bottom:10px;">${(file.data.size/1024/1024).toFixed(2)} MB</div>
                        <a href="${url}" download="${file.name}" class="btn" style="width:100%; justify-content:center; font-size:0.8rem;">Download</a>
                    `;
                    container.appendChild(div);
                });
            };
        }

        // --- SECTION 2: CODE STUDIO LOGIC ---
        
        // Tab Switching
        function setTab(type) {
            document.querySelectorAll('.code-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.code-area').forEach(a => a.style.display = 'none');
            
            event.target.classList.add('active');
            document.getElementById('code-' + type).style.display = 'block';
        }

        // Default Code
        document.getElementById('code-html').value = `<div class="container">\n  <h1>Welcome to Faizan's Hoster</h1>\n  <p>Edit this code or upload a ZIP!</p>\n</div>`;
        document.getElementById('code-css').value = `body { background: #111; color: white; font-family: sans-serif; text-align: center; padding: 50px; }\nh1 { color: #00e5ff; }`;
        document.getElementById('code-js').value = `console.log("Hoster Ready");`;

        // Run Code
        function runCode() {
            const html = document.getElementById('code-html').value;
            const css = document.getElementById('code-css').value;
            const js = document.getElementById('code-js').value;

            const frame = document.getElementById('preview-frame');
            const blob = new Blob([`
                <html>
                <head><style>${css}</style></head>
                <body>${html}<script>${js}<\/script></body>
                </html>
            `], {type: 'text/html'});
            frame.src = URL.createObjectURL(blob);
        }

        // --- THE MAGIC: ZIP & HTML UPLOAD HANDLER ---
        function handleZipUpload(input) {
            const file = input.files[0];
            if (!file) return;

            if (file.name.endsWith('.html')) {
                // Handle Single HTML File
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('code-html').value = e.target.result;
                    runCode();
                    showToast("HTML Imported!");
                };
                reader.readAsText(file);
            } 
            else if (file.name.endsWith('.zip')) {
                // Handle ZIP File using JSZip
                showToast("Extracting Zip...");
                JSZip.loadAsync(file).then(function(zip) {
                    
                    // Reset editors
                    let htmlFound = false;

                    // Iterate through zip contents
                    zip.forEach(function (relativePath, zipEntry) {
                        if (zipEntry.name.endsWith("index.html") || zipEntry.name.endsWith(".html")) {
                            zipEntry.async("string").then(function (content) {
                                if(!htmlFound) { // Only load the first HTML file found
                                    document.getElementById('code-html').value = content;
                                    htmlFound = true;
                                    runCode();
                                }
                            });
                        }
                        if (zipEntry.name.endsWith(".css")) {
                            zipEntry.async("string").then(function (content) {
                                document.getElementById('code-css').value += "\n" + content;
                            });
                        }
                        if (zipEntry.name.endsWith(".js")) {
                            zipEntry.async("string").then(function (content) {
                                document.getElementById('code-js').value += "\n" + content;
                            });
                        }
                    });
                    
                    setTimeout(() => {
                        runCode();
                        showToast("Zip Extracted to Editor!");
                    }, 1000);
                });
            }
        }

        function downloadProject() {
            const html = document.getElementById('code-html').value;
            const blob = new Blob([html], {type: "text/html"});
            const url = URL.createObjectURL(blob);
            const a = document.createElement("a");
            a.href = url;
            a.download = "index.html";
            a.click();
        }

        function showToast(msg) {
            const t = document.getElementById('toast');
            t.innerText = msg;
            t.style.display = 'block';
            setTimeout(() => t.style.display = 'none', 3000);
        }

        // Initial Run
        setTimeout(runCode, 500);

    </script>
</body>
</html>
